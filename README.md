# 排课结果检查器使用说明

## 项目概述

这是一个用于检查排课结果合理性的工具，可以检测以下三种主要问题：

1. **科目重复检查**：确保每一行（每个班级）中每个科目只出现一次
2. **老师时间冲突检查**：确保每一列（同一时间段）中每个老师只有一节课
3. **教室冲突检查**：确保每一列（同一时间段）中每个教室只被使用一次

## 文件说明

### 1. HTML版本（推荐）
- `course_checker.html` - 网页界面，支持拖拽上传Excel文件
- `course_checker.js` - 前端JavaScript检查逻辑

### 2. Node.js版本
- `course_checker_node.js` - 命令行版本，可直接运行
- `package.json` - 项目依赖配置

## 使用方法

### 方法一：网页版本（推荐）

1. 直接双击打开 `course_checker.html` 文件
2. 将您的Excel文件拖拽到上传区域，或点击按钮选择文件
3. 系统会自动分析并显示检查结果

### 方法二：命令行版本

1. 确保已安装Node.js
2. 在项目目录下运行：
   ```bash
   npm install
   node course_checker_node.js course.xlsx
   ```

## Excel文件格式要求

1. **课程信息格式**：每个单元格包含完整的课程信息
   - 格式：`[科目全称] [老师姓名] [教室地点]`
   - 示例：`数学基础 张老师 W404`

2. **科目识别**：程序通过课程全称的第一个字符识别科目
   - 例如：`数学基础` → 科目为 `数`
   - 例如：`物理实验` → 科目为 `物`

3. **艺术体育课程**：以下科目不参与冲突检查
   - 美术（美）、音乐（音）、体育（体）、艺术（艺）、形体（形）

## 检查结果说明

### 问题类型

1. **科目重复**：某行中同一科目出现多次
2. **老师冲突**：同一时间段老师有多节课
3. **教室冲突**：同一时间段教室被多次使用

### 结果展示

- ✅ **绿色**：没有发现问题
- ⚠️ **黄色**：发现问题的汇总信息
- ❌ **红色**：具体的错误详情

### 统计信息

程序还会提供以下统计信息：
- 总课程数量
- 有效课程数（不含艺体课程）
- 艺体课程数
- 涉及的教师数量
- 涉及的科目数量
- 涉及的教室数量
- 数据维度（行数×列数）

## 注意事项

1. **文件格式**：支持 `.xlsx` 和 `.xls` 格式的Excel文件
2. **数据结构**：程序读取第一个工作表的数据
3. **课程格式**：确保课程信息按照指定格式填写
4. **艺体课程**：可以在代码中调整艺体课程的识别标识

## 自定义配置

如需修改艺体课程的识别标识，可以编辑代码中的 `artSportsSubjects` 数组：

```javascript
this.artSportsSubjects = ['美', '音', '体', '艺', '形'];
```

## 技术特性

- 支持大文件处理
- 跨平台兼容（Windows、macOS、Linux）
- 无需安装额外软件（网页版）
- 详细的错误报告和统计信息
- 支持拖拽上传操作

## 故障排除

1. **文件读取失败**：确保Excel文件未被其他程序占用
2. **格式错误**：检查课程信息是否按照指定格式填写
3. **依赖问题**：运行 `npm install` 重新安装依赖

## 当前检查结果

根据对您的 `course.xlsx` 文件的分析（按星期正确分组后），发现了以下问题：

- **老师冲突**：1个问题 - 星期五第7节课杨俊沂老师有2节课
- **教室冲突**：6个问题 - 分布在星期二到星期五的不同节次
- **科目重复**：0个问题

### 具体问题详情：

**老师冲突：**
- 星期五第7节课：杨俊沂老师同时有2节课

**教室冲突：**
- 星期二第3节课：W404教室被使用2次
- 星期三第1节课：W401教室被使用2次  
- 星期三第4节课：W401教室被使用2次
- 星期三第8节课：W404教室被使用2次
- 星期四第3节课：W410教室被使用2次
- 星期五第7节课：W410教室被使用2次

这些问题需要重新调整相关班级的课程安排。

## 联系支持

如有问题或需要功能改进，请提供具体的错误信息和Excel文件样例。
# course-schedule-checker
